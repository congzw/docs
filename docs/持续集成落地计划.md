# 持续集成落地计划（2018）

以终为始：先明确目标，搞清楚我们在哪儿，要往哪儿去，然后在制定具体的实施计划。

## 我们当前的问题

大家对持续集成的认知不足，缺乏相关实践指导

- 对持续集成这件事自身，认识和重视不足
- 版本管理不到位（不是所有的资产都处于版本管理之下，配置项划分方式也有待改善）
- 开发协作流程认识不足（何时提交代码，提交前应该具备哪些条件，提交后还有哪些工作，什么算完成）
- 自动化测试不够，对自动化测试理解不足
- 对反馈重视不够，处理不及时或处理流程缺乏共识

## 成熟度模型

共分5级，目前先要从初始级别达到1级。

## 实施计划

- 启动时正式做一次宣讲
	- 整理笔记，缕清思路
	- 明确概念，统一认识
	- 阐明意义，加强共识
- 小范围内实施验证（部分项目、部分人员参与）
	- 控制范围，平滑过渡
	- 边学边做，不断改善
	- 拆分任务，各个击破

## 关键实践
	- 只维护一个源码库
	- 让构建尽可能自动化
	- 让构建自测试
	- 频繁向主线提交（每人每天都要向主线提交代码）
	- 使用持续构建服务（在集成计算机上重新构建主线的每次提交）
	- 立刻修复构建问题（快速反馈，快速应对）
	- 保持快速构建
	- 在模拟生产环境中进行测试
	- 让每个人都能轻易获得最新的可执行文件
	- 让每个人都能看到进度
	- 自动化部署

## 主线改造计划

确定库列表（nuget）
确定组件列表
构建依赖图（库、组件）


部署流水线的两个通用原则：快速反馈和为相关角色提供可视化状态。
构建失败，哪个阶段失败，为何失败，整理原因。


主干开发模式的隐式要求：

- 持续集成保证（例如，有自动化测试保证）
- 代码结构良好（例如，组件化较好，集成相对平滑和容易）
- 开发人员有较高的要求（例如，有较好的持续集成实践基础，抽象代替分支的能力）

合适的才是最好的，综合考虑实际情况，不能走极端

自动化测试保证良好的前提下： 主干开发模式
自动化测试不是很好的前提下： 分支开发模式

几个大的原则：

- 严格审视分支的创建
- 落实持续集成的相关实践

### 词汇表

代码库： repository（源代码管理工具，配置管理，版本控制系统等）
主线： mainline
签出： checking out
构建： build

